{
  "id": "pdf-processing",
  "name": "PDF Processing",
  "description": "Extract and transform document data with Docling OCR",
  "icon": "file",
  "workflow": {
    "name": "PDF Processing",
    "nodes": [
      {
        "parameters": {},
        "name": "When clicking 'Test workflow'",
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [240, 300]
      },
      {
        "parameters": {
          "jsCode": "// Configure the PDF file path to process\n// Replace this with your actual file path, or pass it from a previous node\nconst filePath = '{{N8N_FILES_FOLDER}}/sample.pdf';\n\n// You can also get the file path from input data:\n// const filePath = $input.first().json.file_path;\n\nreturn [{ json: { file_path: filePath } }];"
        },
        "name": "Set File Path",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [440, 300],
        "notesInFlow": true,
        "notes": "Configure your PDF file path here. Files should be in the n8n-files folder."
      },
      {
        "parameters": {
          "method": "POST",
          "url": "{{DOCLING_API_URL}}/process",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer {{DOCLING_AUTH_TOKEN}}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ JSON.stringify({ file_path: $json.file_path }) }}",
          "options": {}
        },
        "name": "Submit to Docling",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [640, 300]
      },
      {
        "parameters": {
          "jsCode": "// Extract job_id from Docling response\nconst response = $input.first().json;\nif (!response.job_id) {\n  throw new Error('No job_id returned from Docling');\n}\nreturn [{ json: { job_id: response.job_id, status: response.status } }];"
        },
        "name": "Extract Job ID",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [840, 300]
      },
      {
        "parameters": {
          "method": "GET",
          "url": "={{\"{{DOCLING_API_URL}}/jobs/\" + $json.job_id}}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer {{DOCLING_AUTH_TOKEN}}"
              }
            ]
          },
          "options": {}
        },
        "name": "Poll Job Status",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [1040, 300]
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict"
            },
            "conditions": [
              {
                "id": "check-completed",
                "leftValue": "={{ $json.status }}",
                "rightValue": "completed",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "or"
          },
          "options": {}
        },
        "name": "Is Completed?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [1240, 300]
      },
      {
        "parameters": {
          "amount": 2,
          "unit": "seconds"
        },
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [1440, 400],
        "webhookId": "docling-wait"
      },
      {
        "parameters": {
          "jsCode": "// Extract the markdown result from completed job\nconst job = $input.first().json;\n\nif (job.status === 'failed') {\n  return [{\n    json: {\n      error: 'Processing failed',\n      message: job.error || 'Unknown error',\n      error_type: job.error_type\n    }\n  }];\n}\n\nconst result = job.result || {};\nreturn [{\n  json: {\n    markdown: result.markdown || '',\n    metadata: result.metadata || {},\n    status: result.status,\n    job_id: job.job_id,\n    file_path: job.file_path\n  }\n}];"
        },
        "name": "Process Result",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [1440, 200]
      }
    ],
    "connections": {
      "When clicking 'Test workflow'": {
        "main": [
          [
            {
              "node": "Set File Path",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set File Path": {
        "main": [
          [
            {
              "node": "Submit to Docling",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Submit to Docling": {
        "main": [
          [
            {
              "node": "Extract Job ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Job ID": {
        "main": [
          [
            {
              "node": "Poll Job Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Poll Job Status": {
        "main": [
          [
            {
              "node": "Is Completed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Completed?": {
        "main": [
          [
            {
              "node": "Process Result",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Poll Job Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    }
  }
}
